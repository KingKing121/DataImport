#!/usr/bin/env python
# coding=utf-8
import os

import cx_Oracle

os.environ['NLS_LANG'] = 'SIMPLIFIED CHINESE_CHINA.UTF8'
username = "apps"
userpwd = "apps"
host = "20.20.1.20"
port = 1521
dbname = "PROD"

dsn = cx_Oracle.makedsn(host, port, dbname)
db = cx_Oracle.connect(username, userpwd, dsn)

print(db)
print(db.version)

#测试
cur = db.cursor()

dfun = [
    [1.0, '2018', '06', '一二系列', '﹙911﹚1#渣浆泵', '变电站', 7585.23, 7633.51, 10000.0, 482800.0000000065, 1037.9874896178026,
     483837.9874896243, 0.45, 217727.09437033095, 34836.33509925296, ''],
    [2.0, '2018', '06', '一二系列', '﹙931﹚1#碎矿配电 ', '变电站', 5133.62, 5185.05, 6000.0, 308580.00000000175, 663.4262210982995,
     309243.42622110003, 0.45, 139159.54179949503, 22265.52668791919, ''],
    [3.0, '2018', '06', '一二系列', '﹙913﹚1#磨矿配电', '变电站', 7886.63, 7971.78, 6000.0, 510899.9999999978, 1098.4005974435086,
     511998.4005974413, 0.45, 230399.28026884858, 36863.88484301581, ''],
    [4.0, '2018', '06', '一二系列', '﹙917﹚1#自磨机', '变电站', 30556.58, 30934.6, 10000.0, 3780199.999999968, 8127.175452057024,
     3788327.1754520247, 0.45, 1704747.228953411, 272759.5566325458, ''],
    [5.0, '2018', '06', '一二系列', '﹙916﹚1#球磨机', '变电站', 38686.46, 39119.05, 10000.0, 4325900.000000038, 9300.393706167422,
     4335200.393706205, 0.45, 1950840.1771677923, 312134.4283468467, ''],
    [6.0, '2018', '06', '一二系列', '﹙915﹚2#磨矿配电', '变电站', 3096.99, 3134.51, 6000.0, 225120.00000000262, 483.9928410579107,
     225603.99284106054, 0.45, 101521.79677847725, 16243.48748455636, ''],
    [7.0, '2018', '06', '一二系列', '﹙919﹚浮选配电2 ', '变电站', 12583.62, 12713.81, 6000.0, 781139.9999999921, 1679.3984002486147,
     782819.3984002407, 0.44999999999999996, 352268.7292801083, 56362.996684817364, ''],
    [8.0, '2018', '06', '一二系列', '﹙920﹚浮选配电3 ', '变电站', 12228.06, 12340.2, 6000.0, 672840.0000000075, 1446.5606928633815,
     674286.5606928709, 0.45, 303428.9523117919, 48548.632369886735, ''],
    [9.0, '2018', '06', '一二系列', '﹙921﹚选厂配电1 ', '变电站', 9037.31, 9143.15, 6000.0, 635040.0000000009, 1365.2932382081221,
     636405.2932382091, 0.45000000000000007, 286382.3819571941, 45821.18111315102, ''],
    [10.0, '2018', '06', '一二系列', '（918）精矿配电', '变电站', 4976.08, 5016.32, 6000.0, 241439.9999999987, 519.079742115405,
     241959.0797421141, 0.45, 108881.58588395134, 17421.053741432217, ''],
    [11.0, '2018', '06', '一二系列', '（934）2#鼓风机', '变电站', 8007.37, 8102.08, 6000.0, 568260.0000000002, 1221.720734983854,
     569481.720734984, 0.45, 256266.77433074283, 41002.68389291887, ''],
    [12.0, '2018', '06', '一二系列', '﹙932﹚2#碎矿配电 ', '变电站', 7667.57, 7746.77, 6000.0, 475200.00000000437,
     1021.6480013802354, 476221.6480013846, 0.45, 214299.74160062306, 34287.95865609968, ''],
    [13.0, '2018', '06', '一二系列', '﹙930﹚浮选配电1 ', '变电站', 12425.69, 12548.86, 6000.0, 739020.0000000005,
     1588.8432364899309, 740608.8432364904, 0.45, 333273.9794564207, 53323.836713027325, ''],
    [14.0, '2018', '06', '一二系列', '﹙929﹚浮选配电4 ', '变电站', 6956.54, 7021.59, 6000.0, 390300.0000000011, 839.1187183053522,
     391139.1187183065, 0.45, 176012.60342323792, 28162.016547718085, ''],
    [15.0, '2018', '06', '一二系列', '﹙927﹚选厂配电2 ', '变电站', 9966.04, 10072.12, 6000.0, 636479.9999999995, 1368.3891412426049,
     637848.3891412421, 0.45, 287031.775113559, 45925.08401816944, ''],
    [16.0, '2018', '06', '一二系列', '﹙924﹚2#球磨机 ', '变电站', 38281.14, 38650.2, 10000.0, 3690599.9999999767,
     7934.541485466832, 3698534.5414854437, 0.45, 1664340.5436684496, 266294.48698695214, ''],
    [17.0, '2018', '06', '一二系列', '﹙912﹚2#渣浆泵 ', '变电站', 8019.92, 8117.22, 10000.0, 973000.0000000019, 2091.8844809405764,
     975091.8844809424, 0.45, 438791.3480164241, 70206.61568262783, ''],
    [18.0, '2018', '06', '一二系列', '﹙925﹚2#自磨机 ', '变电站', 30998.26, 31306.15, 10000.0, 3078900.0000000307,
     6619.427675609447, 3085519.42767564, 0.45000000000000007, 1388483.7424540382, 222157.39879264613, ''],
    [19.0, '2018', '06', '一二系列', '一期出碎站', '采场箱变', 7987.01, 8127.02, 1000.0, 140010.00000000023, 301.0120721238335,
     140311.01207212405, 0.45, 63139.95543245583, 10102.392869192932, ''],
    [20.0, '2018', '06', '三系列', '(二期973)1#渣浆泵配电', '变电站', 6809.75, 6897.9, 10000.0, 881499.9999999964, 1895.165642290963,
     883395.1656422873, 0.45, 397527.82453902933, 63604.451926244656, ''],
    [21.0, '2018', '06', '三系列', '(二期974)2#渣浆泵配电', '变电站', 4704.75, 4782.39, 10000.0, 776400.0000000033,
     1669.2077194267904, 778069.2077194301, 0.45000000000000007, 350131.1434737436, 56020.98295579897, ''],
    [22.0, '2018', '06', '三系列', '(二期975)1#碎矿配电', '变电站', 3144.16, 3194.16, 10000.0, 500000.0, 1074.966331418588,
     501074.9663314186, 0.45, 225483.7348491384, 36077.39757586212, ''],
    [23.0, '2018', '06', '三系列', '(二期976)2#碎矿配电', '变电站', 1473.86, 1497.41, 10000.0, 235500.0000000018, 506.3091420981588,
     236006.30914209996, 0.45, 106202.83911394498, 16992.4542582312, ''],
    [24.0, '2018', '06', '三系列', '(二期977)1#自磨机', '变电站', 22370.43, 22702.28, 10000.0, 3318499.9999999856,
     7134.551541625137, 3325634.5515416106, 0.45, 1496535.5481937248, 239445.68771099602, ''],
    [25.0, '2018', '06', '三系列', '(二期978)2#自磨机', '变电站', 22295.47, 22625.7, 10000.0, 3302299.999999996, 7099.722632487197,
     3309399.722632483, 0.45, 1489229.8751846175, 238276.7800295388, ''],
    [26.0, '2018', '06', '三系列', '(二期995)1#球磨机', '变电站', 20762.41, 21090.3, 16000.0, 5246239.999999991,
     11279.062733082887, 5257519.062733074, 0.45, 2365883.578229883, 378541.37251678156, ''],
    [27.0, '2018', '06', '三系列', '(二期999)2#球磨机', '变电站', 21214.29, 21546.26, 16000.0, 5311519.999999961,
     11419.410337312833, 5322939.410337274, 0.45, 2395322.7346517732, 383251.63754428364, ''],
    [28.0, '2018', '06', '三系列', '(二期979)粗碎配电', '变电站', 1197.61, 1212.55, 10000.0, 149400.00000000055, 321.1999398278753,
     149721.19993982842, 0.45, 67374.5399729228, 10779.926395667644, ''],
    [29.0, '2018', '06', '三系列', '(二期987)磨矿配电', '变电站', 3192.37, 3240.73, 10000.0, 483600.0000000013, 1039.707435748061,
     484639.70743574935, 0.45, 218087.86834608723, 34894.058935373934, ''],
    [30.0, '2018', '06', '三系列', '(二期988)脱水干燥配电', '变电站', 1777.39, 1807.28, 10000.0, 298899.9999999987, 642.6148729220291,
     299542.61487292073, 0.45, 134794.17669281433, 21567.068270850286, ''],
    [31.0, '2018', '06', '三系列', '(二期991)1#选矿配电', '变电站', 3714.39, 3772.77, 12000.0, 700560.0000000013,
     1506.1568262772148, 702066.1568262785, 0.44999999999999996, 315929.7705718253, 50548.76329149207, ''],
    [32.0, '2018', '06', '三系列', '(二期992)2#选矿配电', '变电站', 3106.19, 3161.53, 12000.0, 664080.0000000017,
     1427.7272827369156, 665507.7272827387, 0.45, 299478.4772772324, 47916.55636435718, ''],
    [33.0, '2018', '06', '三系列', '(二期993)1#鼓风机配电', '变电站', 6486.15, 6560.3, 12000.0, 889800.0000000065,
     1913.0100833925333, 891713.010083399, 0.45, 401270.8545375296, 64203.33672600472, ''],
    [34.0, '2018', '06', '三系列', '(二期994)2#鼓风机配电', '变电站', 7687.24, 7809.18, 12000.0, 1463280.000000006,
     3145.953466876396, 1466425.9534668825, 0.45, 659891.6790600971, 105582.6686496156, ''],
    [35.0, '2018', '06', '尾矿', '（926）2#尾矿', '变电站', 6988.96, 7063.53, 10000.0, 739099.9999999971, 1589.0152311029506,
     740689.0152311, 0.45, 333310.056853995, 53329.60909663921, ''],
    [36.0, '2018', '06', '尾矿', '（321）隔膜泵配电', '变电站', 4232.8, 4291.66, 28000.0, 1648079.999999991, 3543.2610229686734,
     1651623.2610229596, 0.45, 743230.4674603319, 118916.87479365314, ''],
    [37.0, '2018', '06', '尾矿', '（923）1#尾矿', '变电站', 1071.99, 1079.14, 10000.0, 71500.0000000009, 153.72018539286003,
     71653.72018539376, 0.45, 32244.17408342719, 5159.0678533483515, ''],
    [38.0, '2018', '06', '尾矿', '新建泵站（坝下1#泵）', '十冶后建泵房', 9569.0, 9669.0, 120.0, 12000.0, 25.799191954046112,
     12025.799191954045, 0.45, 5411.60963637932, 865.857541820692, ''],
    [39.0, '2018', '06', '质检中心', '(910)化验室', '配电室', 10450.0, 10557.0, 120.0, 12840.0, 27.60513539082934,
     12867.60513539083, 0.45, 5790.422310925874, 926.4675697481398, ''],
    [40.0, '2018', '06', '质检中心', '化验室循环风间', '选厂箱变', 1032.0, 1035.0, 80.0, 240.0, 0.5159838390809223, 240.51598383908092,
     0.44999999999999996, 108.23219272758641, 17.31715083641383, ''],
    [41.0, '2018', '06', '质检中心', '(910)样品库', '配电间', 1579.0, 1604.0, 40.0, 1000.0, 2.149932662837176, 1002.1499326628372,
     0.45, 450.9674696982767, 72.15479515172427, ''],
    [42.0, '2018', '06', '质检中心', '(910)地磅房', '生产区315变', 16959.0, 17377.0, 1.0, 418.0, 0.8986718530659396,
     418.89867185306593, 0.45, 188.50440233387968, 30.160704373420742, ''],
    [43.0, '2018', '06', '保障部', '(922)行政办公楼（照明）', '办公楼配电', 10180.0, 10347.0, 120.0, 20040.0, 43.08465056325701,
     20083.084650563258, 0.45, 9037.388092753466, 1445.982094840554, ''],
    [44.0, '2018', '06', '保障部', '(922)行政办公楼（动力）', '办公楼配电', 14278.0, 14429.0, 60.0, 9060.0, 19.478389925304814,
     9079.478389925305, 0.45, 4085.7652754663873, 653.7224440746227, ''],
    [45.0, '2018', '06', '保障部', '(922)综合楼（照明）', '锅炉房配电间', 7192.0, 7248.0, 40.0, 2240.0, 4.815849164755274,
     2244.8158491647555, 0.45, 1010.16713212414, 161.62674113986247, ''],
    [46.0, '2018', '06', '保障部', '(922)服务楼（动力）', '锅炉房配电间', 34150.0, 34362.0, 80.0, 16960.0, 36.462857961718505,
     16996.46285796172, 0.45, 7648.408286082774, 1223.745325773244, ''],
    [47.0, '2018', '06', '保障部', '(922)生活区1#宿舍楼', '1#楼配电间', 13420.0, 13506.0, 60.0, 5160.0, 11.093652540239828,
     5171.093652540239, 0.45, 2326.9921436431077, 372.3187429828972, ''],
    [48.0, '2018', '06', '保障部', '(922)生活区2#宿舍楼', '2#楼配电间', 9039.0, 9103.0, 80.0, 5120.0, 11.007655233726341,
     5131.007655233726, 0.45, 2308.9534448551767, 369.4325511768284, ''],
    [49.0, '2018', '06', '保障部', '(910)生产区食堂(新）', '选厂箱变', 18163.0, 18414.0, 80.0, 20080.0, 43.17064786977049,
     20123.17064786977, 0.45, 9055.426791541397, 1448.8682866466243, ''],
    [50.0, '2018', '06', '保障部', '园林绿化', '生活区', 19509.0, 19559.0, 1.0, 50.0, 0.1074966331418588, 50.10749663314186, 0.45,
     22.548373484913835, 3.6077397575862165, ' '],
    [51.0, '2018', '06', '保障部', '多功能会议厅', '生活区', 1626.0, 1679.0, 160.0, 8480.0, 18.231428980859253, 8498.23142898086,
     0.45, 3824.204143041387, 611.872662886622, ''],
    [52.0, '2018', '06', '保障部', '车库（皮卡车）', '选厂箱变', 32026.0, 32592.0, 1.0, 566.0, 1.2168618871658416, 567.2168618871658,
     0.45, 255.24758784922463, 40.839614055875956, ''],
    [53.0, '2018', '06', '保障部', '（910）车库(大客车）', '选厂箱变', 1272.0, 1281.0, 15.0, 135.0, 0.2902409094830188,
     135.29024090948303, 0.45, 60.88060840926737, 9.740897345482779, ''],
    [54.0, '2018', '06', '保障部', '（910）车库(消防）', '选厂箱变', 7619.0, 7767.0, 15.0, 2220.0, 4.772850511498531,
     2224.7728505114987, 0.45, 1001.1477827301744, 160.18364523682794, ''],
    [55.0, '2018', '06', '保障部', '（922）生活区庭院照明', '生活区', 396747.0, 400525.0, 1.0, 3778.0, 8.122445600198851,
     3786.1224456001987, 0.45, 1703.7551005200894, 272.60081608321434, ''],
    [56.0, '2018', '06', '保障部', '生产区浴池', '浴池内', 11784.0, 12059.0, 20.0, 5500.0, 11.824629645604467, 5511.824629645605,
     0.44999999999999996, 2480.321083340522, 396.8513733344839, ''],
    [57.0, '2018', '06', '保障部', '(910)生产综合办公楼', '选厂箱变（楼内表）', 11081.0, 11323.0, 40.0, 9680.0, 20.811348176263863,
     9700.811348176263, 0.44999999999999996, 4365.365106679318, 698.4584170686912, ''],
    [58.0, '2018', '06', '检修厂', '检修厂配电', '变电站', 19.62, 20.37, 10000.0, 7500.0, 16.12449497127882, 7516.124494971279,
     0.44999999999999996, 3382.2560227370755, 541.1609636379326, ''],
    [59.0, '2018', '06', '检修厂', '（922）生活区污水泵房', '生活区', 205.0, 225.0, 15.0, 300.0, 0.6449797988511528, 300.6449797988511,
     0.45, 135.290240909483, 21.6464385455173, ''],
    [60.0, '2018', '06', '检修厂', '（922）生产区污水泵房', '锅炉房1#配电间', 251799.0, 255726.0, 1.0, 3927.0, 8.44278556696159,
     3935.4427855669614, 0.45, 1770.9492535051327, 283.3518805608214, ''],
    [61.0, '2018', '06', '检修厂', '（922)生活区水泵房', '生活区', 25904.0, 26044.0, 80.0, 11200.0, 24.079245823776372,
     11224.079245823776, 0.45, 5050.835660620699, 808.1337056993125, ''],
    [62.0, '2018', '06', '检修厂', '(926)供水检修班', '高位水池', 17767.0, 17987.0, 30.0, 6600.0, 14.189555574725361,
     6614.189555574725, 0.45, 2976.3853000086265, 476.22164800138034, ''],
    [63.0, '2018', '06', '检修厂', '（926)高位水池', '高位水池', '', '', '', '', 0.0, 0.0, '', 0.0, 0.0, ''],
    [64.0, '2018', '06', '检修厂', '(312)水源配电', '变电站', 9544.46, 9680.97, 7000.0, 955570.0000000015, 2054.4111546273234,
     957624.4111546288, 0.44999999999999996, 430930.98501958296, 68948.95760313334, ''],
    [65.0, '2018', '06', '检修厂', '中水泵站1084177312', '中水泵站', 1910.91, 2040.68, 4000.0, 519079.99999999994, 0.0, '',
     0.44411508823302775, 230531.26, 39190.31, ''],
    [66.0, '2018', '06', '检修厂', '新泵站1802439278', '满里去扎区路上', 10067.17, 10253.9, 1400.0, 261421.9999999994, '', '',
     0.45502616459211653, 118953.85, 20222.16, ''],
    [67.0, '2018', '06', '检修厂', '（911）生产区锅炉房', '锅炉房2#配电间', 28259.0, 28663.0, 300.0, 117273.0, 252.12905316890414,
     117525.1290531689, 0.45, 52886.308073926004, 8461.809291828162, ''],
    [68.0, '2018', '06', '检修厂', '水处理管道电伴热', '生活区箱变', 174453.0, 177077.0, 1.0, 2624.0, 5.64142330728475,
     2629.6414233072846, 0.45, 1183.338640488278, 189.3341824781246, ''],
    [69.0, '2018', '06', '供应部', '（910）1号供应库房', '选厂箱变', 51798.0, 52184.0, 1.0, 386.0, 0.82987400785515,
     386.82987400785515, 0.45, 174.07344330353482, 27.851750928565593, ''],
    [70.0, '2018', '06', '供应部', '(910)2#供应库房', '选厂箱变', 350.0, 353.0, 20.0, 60.0, 0.12899595977023057, 60.12899595977023,
     0.44999999999999996, 27.058048181896602, 4.329287709103458, ''],
    [71.0, '2018', '06', '供应部', '(910)4#供应库房', '选厂箱变', 2125.0, 2134.0, 20.0, 180.0, 0.3869878793106917,
     180.38698787931068, 0.45000000000000007, 81.17414454568981, 12.987863127310362, ''],
    [72.0, '2018', '06', '供应部', '(910)5#供应库房', '选厂箱变', 1138.0, 1145.0, 20.0, 140.0, 0.30099057279720465,
     140.30099057279722, 0.45, 63.13544575775875, 10.101671321241405, ''],
    [73.0, '2018', '06', '设备能源部', '(910)2号设备库房', '4#库房', 19295.0, 19526.0, 1.0, 231.0, 0.4966344451153877,
     231.49663444511538, 0.45, 104.17348550030192, 16.66775768004831, ''],
    [74.0, '2018', '06', '设备能源部', '（910）1号设备库房', '1#库内', 57772.0, 58003.0, 1.0, 231.0, 0.4966344451153877,
     231.49663444511538, 0.45, 104.17348550030192, 16.66775768004831, ''],
    [75.0, '2018', '06', '设备能源部', '（910）生产区马路照明', '选厂箱变', 173358.0, 177653.0, 1.0, 4295.0, 9.233960786885671,
     4304.233960786885, 0.45, 1936.9052823540985, 309.9048451766555, ''],
    [76.0, '2018', '06', '设备能源部', '﹙961﹚1#所变电', '变电站', 1204.29, 1210.62, 3000.0, 18989.99999999978, 40.8272212672775,
     19030.82722126706, 0.45, 8563.872249570177, 1370.219559931229, ''],
    [77.0, '2018', '06', '保卫部', '（922）炸药库房              ', '炸药厂变', 412425.0, 414469.0, 1.0, 2044.0, 4.394462362839188,
     2048.394462362839, 0.45, 921.7775080632775, 147.48440129012442, ''],
    [78.0, '2018', '06', '保卫部', '（910）废铁厂', '废铁厂内', 36965.0, 37074.0, 1.0, 109.0, 0.23434266024925218,
     109.23434266024925, 0.45, 49.155454197112164, 7.864872671537952, ''],
    [79.0, '2018', '06', '保卫部', '(910)派出所', '选厂箱变', 234050.0, 235634.0, 1.0, 1584.0, 3.405493337934087,
     1587.405493337934, 0.45, 714.3324720020704, 114.29319552033121, ''],
    [80.0, '2018', '06', '保卫部', '（910）生产区门卫房', '生产区315变', 210935.0, 212311.0, 1.0, 1376.0, 2.9583073440639542,
     1378.958307344064, 0.45, 620.5312383048288, 99.28499812877271, ''],
    [81.0, '2018', '06', '（318采矿配电）采矿厂', '采场(1)', '采场箱变', 639.66, 687.59, 8000.0, 231430.0000000003, 497.5589161604083,
     231927.5589161607, 0.44999999999999996, 104367.4015122723, 16698.784241963585, '一月份新换表'],
    [82.0, '2018', '06', '（318采矿配电）采矿厂', '采场(2)', '采场箱变', 5203.48, 5289.16, 8000.0, 685440.0000000023,
     1473.6498444151189, 686913.6498444175, 0.44999999999999996, 309111.14242998784, 49457.7827887981, ''],
    [83.0, '2018', '06', '（318采矿配电）采矿厂', '采场(4)', '采场箱变', 1509.34, 1588.81, 8000.0, 635760.0000000002,
     1366.8411897253636, 637126.8411897256, 0.45, 286707.0785353765, 45873.13256566023, '']]

print(len(dfun))

for item in dfun:
    for index, i in enumerate(item):
        if index == 0:  # 第一列值取整
            item[index] = int(i)
        if i == '' and index != 15:  # null值替换
            item[index] = 0.00
        if 15 > index > 5:
            item[index] = "%.7f" % item[index]

for item in dfun:
    print(len(item))

insert_sql = "insert into CUX_BI_electricity (seq_num, elec_year,elec_month,factory_name, return_circui,install_site,last_mon_elec_meter,cur_mon_elec_meter,elec_rate,elec_kwh,loss_kwh,elec_sum_kwh,elec_price,elec_fee,deduction_tax_fee,elec_notes)  values(:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16)"

ss = [(67, '2018', '06', '检修厂', '（911）生产区锅炉房', '锅炉房2#配电间',
       28259.0, 28663.0, 300.0, 117273.0, 252.1290531, 117525.1290531,
       0.45, 52886.3080739, 8461.8092918, '15'),
      (67, '2018', '06', '检修厂', '（911）生产区锅炉房', '锅炉房2#配电间',
       28259.0, 28663.0, 300.0, 117273.0, 252.1290531, 117525.1290531,
       0.45, 52886.3080739, 8461.8092918, '15')]

# cur.prepare(insert_sql)
cur.executemany(insert_sql, dfun)

db.commit()
